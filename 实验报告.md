实验三

一、实验目的

通过SIFT算法提取并匹配图像特征点进行几何变换，结合RANSAC算法实现图像配准与拼接，完成对图片的拼接。

二、实验内容

1.实验环境搭建与图像数据准备：配置 OpenCV 等计算机视觉库，选取 2 张具有重叠区域的图像作为实验素材；

2.SIFT 特征提取与描述：利用 SIFT 算法提取两张图像的特征关键点及对应的描述子；

3.特征点匹配与筛选：通过 FLANN 匹配器完成特征点初步匹配，再用 Lowe's 比率测试筛选优质匹配对；

4.单应矩阵估计与图像变换：借助 RANSAC 算法剔除误匹配点（外点），估计图像间的单应矩阵（透视变换矩阵），并基于该矩阵对其中一张图像进行透视变换；

5.图像拼接与结果可视化：将变换后的图像与另一张原图进行拼接融合，同时可视化特征匹配过程、拼接结果

三、实验原理

SIFT 特征提取：尺度不变特征变换（SIFT）算法能在不同尺度、旋转、光照条件下提取图像的关键点，并生成 128 维的描述子，用于表征关键点的局部特征，保障特征的唯一性与鲁棒性。
特征匹配与筛选：

FLANN 匹配器：通过快速最近邻搜索算法，高效匹配两张图像的 SIFT 描述子，得到初始匹配对；

RANSAC 与单应矩阵：随机抽样一致（RANSAC）算法通过多次随机选取少量匹配点估计单应矩阵（透视变换矩阵），并统计符合该矩阵的内点数量，最终得到鲁棒的单应矩阵（可剔除误匹配外点）；单应矩阵用于将其中一张图像映射到另一张图像的坐标系，实现图像配准。

四、实验步骤
1.SIFT特征提取

<img width="1014" height="324" alt="image" src="https://github.com/user-attachments/assets/b89fd020-181e-4488-aa81-7fea4d674d14" />


特征点可视化结果如图所示:
<img width="1151" height="863" alt="图片1" src="https://github.com/user-attachments/assets/46412fbb-b6de-4378-bc5b-9f2d33b0f35d" />

2.特征匹配和筛选

<img width="1041" height="411" alt="image" src="https://github.com/user-attachments/assets/93c48185-3031-49b5-9173-7239cb85f464" />


特征匹配可视化如图所示：

<img width="400" height="314" alt="图片2" src="https://github.com/user-attachments/assets/d5420598-7d80-4194-94dc-5022402feeea" />

3.单应矩阵估计与图像变换

<img width="981" height="576" alt="image" src="https://github.com/user-attachments/assets/27f459d1-ee03-46d7-ab92-ba68f6d17b3f" />


这一步的核心是通过单应矩阵实现两张图像的几何对齐，并通过可视化直观展示这一过程，为最终拼接做准备，主要包含两个关键部分：
单应矩阵估计与内点筛选利用 RANSAC 算法从之前筛选出的特征匹配点中，找到能描述两张图像透视变换关系的单应矩阵（M）。过程中会区分 “内点”（绿色匹配线，符合几何约束的可靠匹配）和 “外点”（红色匹配线，偏离约束的误匹配），剔除外点后得到更鲁棒的变换矩阵。
图像透视变换与对齐可视化用得到的单应矩阵（M）对其中一张图像（如 img_a）做透视变换，将其 “映射” 到另一张图像（如 img_b）的坐标系下。通过对比变换前后的图像、以及变换后图像与目标图像的半透明叠加效果，直观展示两张图像的重叠区域是否对齐 —— 对齐越好，说明单应矩阵越准确，为后续拼接奠定基础。

单应矩阵：

<img width="711" height="330" alt="image" src="https://github.com/user-attachments/assets/25859577-75cb-4242-bc69-b02359b9ca67" />


单应矩阵是一个 3×3 的矩阵，它能精确描述 “一张图像上的点如何通过透视变换（比如旋转、缩放、视角调整）映射到另一张图像上”。因为特征匹配中难免有错误匹配（外点），所以用 RANSAC 算法从匹配点中 “挑出” 大多数正确的点（内点），计算出它们共同符合的单应矩阵 —— 这样得到的矩阵能更可靠地反映两张图的几何关系。
图像变换：

4.拼接和可视化

<img width="999" height="558" alt="image" src="https://github.com/user-attachments/assets/aa301c2f-db98-4678-9fc8-d6f13e53bcd1" />


五、实验结果与分析
结果如图所示：

<img width="415" height="150" alt="image" src="https://github.com/user-attachments/assets/a18532a1-7de2-4cab-a2e3-1e10e27b7261" />

分析：
拼接图的黑框，核心是透视变换让像素坐标偏移（比如出现负坐标或超出原图尺寸），为装下这些偏移像素必须扩大图像，而扩大的空白区域会被默认填黑。
分辨率差异会让黑框更明显（比如低分辨率图变换到高分辨率图坐标系时，需更大图像尺寸），但不是黑框产生的根本原因。
